


    $(document).ready(function () {
        if (!(/\.namecheap\.com$/.test(window.location.hostname) || window.location.hostname == "localhost")) {
            
            return;
        }
        else {
            var global_userinfo = {"SupportPin":"5042","UserName":"eakman","NameOfTheUser":"Eitan Akman","RecentMessages":null,"AccountPanelSiteUrl":"https://ap.www.namecheap.com/","CMSSiteUrl":"https://www.namecheap.com/","IsLeaveMessages":false,"IsFromCMS":false}

            if (global_userinfo == null) {
                $("nav div.feed").remove();
                $("nav div.top-hat li.user-menu div.container p.pin").remove();
                $("body").addClass("login").removeClass("loggedin");
                if (typeof (NcGlobal) !== "undefined") NcGlobal.IsLoggedIn = false;
            }
            else {
                if (global_userinfo.NameOfTheUser != null && typeof (global_userinfo.NameOfTheUser) != undefined && global_userinfo.NameOfTheUser != '')
                    $(".top-hat .user-menu > .panel > .user-options > .container p.customer").text(global_userinfo.NameOfTheUser);
                else
                    $(".top-hat .user-menu > .panel > .user-options > .container p.customer").closest("div.group").remove();

                if (global_userinfo.UserName != null && typeof (global_userinfo.UserName) != undefined && global_userinfo.UserName != '') {
					sessionStorage && sessionStorage.setItem('userKey', global_userinfo.UserName);
					$(".top-hat .user-menu > .panel > .user-options > .container p.username").text(global_userinfo.UserName);
                    $(".top-hat .user-menu > a > span[data-username]").text(global_userinfo.UserName);
                    $("body").addClass("loggedin").removeClass("login");
                    if (typeof (NcGlobal) !== "undefined") NcGlobal.IsLoggedIn = true;
                }
                else {
                    $(".top-hat .user-menu > .panel > .user-options > .container p.username").closest("div.group").remove();
                    $("body").addClass("login").removeClass("loggedin");
                    if (typeof (NcGlobal) !== "undefined") NcGlobal.IsLoggedIn = false;
                }

                if (global_userinfo.SupportPin != null && typeof (global_userinfo.SupportPin) != undefined && global_userinfo.SupportPin != '')
                    $(".top-hat .user-menu > .panel > .user-options > .container p.pin").text(global_userinfo.SupportPin);
                else
                    $(".top-hat .user-menu > .panel > .user-options > .container p.pin").closest("div.group").remove();

                if (global_userinfo.IsLeaveMessages == false) {
                    var dataUrl = "";
                    if (global_userinfo.IsFromCMS == false)
                        dataUrl = global_userinfo.AccountPanelSiteUrl + "SiteServices/GetRecentMessagesJson";
                    else
                        dataUrl = global_userinfo.CMSSiteUrl + "cart/ajax/messagehandler.ashx";
                    try {
                        $.ajax({
                            type: 'GET',
                            url: dataUrl,
                            async: true,
                            success: function (result) {
                                if (result == null || result.TotalMessages == null || result.TotalMessages == 0) {
                                    $("nav div.feed").remove();
                                }
                                else {
                                    $("nav div.feed").show();
                                    if (result.TotalUnreadMessages > 0) {
                                        if ($("div.feed span.notification-control").hasClass("notification") == false)
                                            $("div.feed span.notification-control").addClass("notification");
                                        $("div.feed span.notification-control").text('!').show();
                                    }
                                    else {
                                        if ($("div.feed span.notification-control").hasClass("notification"))
                                            $("div.feed span.notification-control").removeClass("notification");
                                    }
                                    if (result.Messages) {
                                        $.each(result.Messages, function (i, message) {
                                            var liClass = "message";
                                            if (message.IsRead != true) {
                                                liClass = "message unread";
                                            }
                                            $("nav div.feed div.content ul").append('<li class="' + liClass + '"><p><a href="' + global_userinfo.AccountPanelSiteUrl + '/dashboard/messages/messagedetails/' + message.ReferenceId + '">' + message.Subject + '<span class="date">' + message.DateString + '</span></a></p></li>');
                                        });
                                    }
                                }
                            },
                            error: function (result) {
                                $("nav div.feed").remove();
                            }
                        });
                    }
                    catch (err) {
                        $("nav div.feed").remove();
                    }
                }
            }
        }
    });
    